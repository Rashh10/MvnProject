pipeline {
    agent any
    stages {
        
        stage('Cleaning Stage') {
            steps {
                bat "mvn clean"
            }
        }
        stage('Testing Stage') {
            steps {
                bat "mvn test"
            }
        }
        stage('Packaging Stage') {
            steps {
                bat "mvn package"
            }
        }
        stage('Deploy')
        {
            steps
            {
                nexusArtifactUploader artifacts: [[artifactId: 'jenkins', classifier: '', file: 'target/Jenkins-0.0.1-SNAPSHOT.jar', type: 'jar']], credentialsId: 'nexus', groupId: 'com.rashu.jenkins', nexusUrl: 'localhost:8081', nexusVersion: 'nexus3', protocol: 'http', repository: 'jenkins-snapshots', version: '0.0.1-SNAPSHOT'
            }
        }
        stage('SonarQube Stage') {
            steps {
                bat "mvn clean test sonar:sonar -D sonar.login=108879aeb256d582c404d5f8f42a0c7c8d4b675a"
            }
        }
         stage('SonarQube'){
        withSonarQubeEnv(credentialsId: 'dummy') {
            bat "mvn sonar:sonar -D sonar.login=108879aeb256d582c404d5f8f42a0c7c8d4b675a"
            
    // some block
    }
    }
    stage('Quality Gate') {
       waitForQualityGateabortPipeline: true
        
    }
    
    stage('Results') {
        junit '**/target/surefire-reports/TEST-*.xml'
        archiveArtifacts'target/*.jar'
    }
}
    
    }
    
}
